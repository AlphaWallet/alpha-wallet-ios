//
// Created by James Sangalli on 2019-07-17.
//

import Foundation
import XCTest
@testable import AlphaWallet

class TokenScriptSignatureVerifierTest: XCTestCase {

    func testValidatorAPIPassed() {
        let expectation = XCTestExpectation(description: "validation passes")
        let tokenScriptSignatureVerifier = TokenScriptSignatureVerifier()
        // swiftlint:disable:next line_length
        let uniswapTokenTSML = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><ts:token xmlns:ts=\"http://tokenscript.org/2020/06/tokenscript\" xmlns:ethereum=\"urn:ethereum:constantinople\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" custodian=\"false\" xsi:schemaLocation=\"http://tokenscript.org/2020/06/tokenscript http://tokenscript.org/2020/06/tokenscript.xsd\">\r\n    <ts:label>\r\n        <ts:string xml:lang=\"en\">Uniswap SAI V1</ts:string>\r\n    </ts:label>\r\n    <ts:contract interface=\"erc20\" name=\"uniswap\">\r\n        <ts:address network=\"1\">0x09cabEC1eAd1c0Ba254B09efb3EE13841712bE14</ts:address>     <!--mainnet-->\r\n    </ts:contract>\r\n\r\n    <ts:origins>\r\n        <!-- Define the contract which holds the token that the user will use -->\r\n        <ts:ethereum contract=\"uniswap\"/> <!-- as above ts:contract name -->\r\n    </ts:origins>\r\n\r\n    <ts:cards>\r\n        <ts:card type=\"action\">\r\n            <ts:label>\r\n                <ts:string xml:lang=\"en\">About</ts:string>\r\n            </ts:label>\r\n            <ts:view xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\">\r\n                <style type=\"text/css\">h3 { color: #111; font-family: 'Open Sans', sans-serif; font-size: 20px; font-weight: 300; line-height: 32px; }\r\n\r\n#inputBox {\r\n  text-align: center;\r\n}\r\n\r\nhtml,\r\nbody {\r\n  height: 100%;\r\n}\r\nhtml {\r\n  font-size: 14px;\r\n}\r\nbody {\r\n  margin: 0px;\r\n  padding: 0px;\r\n  overflow-x: hidden;\r\n  min-width: 320px;\r\n  background: #FFFFFF;\r\n  font-family: 'Lato', 'Helvetica Neue', Arial, Helvetica, sans-serif;\r\n  font-size: 14px;\r\n  line-height: 1.4285em;\r\n  color: rgba(0, 0, 0, 0.87);\r\n  font-smoothing: antialiased;\r\n}\r\n.ui.container {\r\n  display: block;\r\n  max-width: 100% !important;\r\n}\r\n@media only screen and (max-width: 767px) {\r\n  .ui.container {\r\n    width: auto !important;\r\n    margin-left: 1em !important;\r\n    margin-right: 1em !important;\r\n  }\r\n}\r\n@media only screen and (min-width: 768px) and (max-width: 991px) {\r\n  .ui.container {\r\n    width: 723px;\r\n    margin-left: auto !important;\r\n    margin-right: auto !important;\r\n  }\r\n}\r\n@media only screen and (min-width: 992px) and (max-width: 1199px) {\r\n  .ui.container {\r\n    width: 933px;\r\n    margin-left: auto !important;\r\n    margin-right: auto !important;\r\n  }\r\n}\r\n@media only screen and (min-width: 1200px) {\r\n  .ui.container {\r\n    width: 1127px;\r\n    margin-left: auto !important;\r\n    margin-right: auto !important;\r\n  }\r\n}\r\n.ui.segment {\r\n  position: relative;\r\n  background: #FFFFFF;\r\n  -webkit-box-shadow: 0px 1px 2px 0 rgba(34, 36, 38, 0.15);\r\n  box-shadow: 0px 1px 2px 0 rgba(34, 36, 38, 0.15);\r\n  margin: 0.5rem 0em;\r\n  padding: 0.5em 0.5em;\r\n  border-radius: 0.28571429rem;\r\n  border: 1px solid rgba(34, 36, 38, 0.15);\r\n  text-align: center;\r\n}\r\n.ui.segment:first-child {\r\n  margin-top: 0em;\r\n}\r\n.ui.segment:last-child {\r\n  margin-bottom: 0em;\r\n}\r\ninput {\r\n  position: relative;\r\n  font-weight: normal;\r\n  font-style: normal;\r\n  font-size: 12px;\r\n  display: -ms-inline-flexbox;\r\n  display: inline-flex;\r\n  color: rgba(0, 0, 0, 0.87);\r\n  padding: 9.5px 14px;\r\n  width: 300px;\r\n  border-color: #D8D8D8;\r\n}\r\ninput[type=text]:focus {\r\n  border-color: #D8D8D8;\r\n  background: #FAFAFA;\r\n  color: rgba(0, 0, 0, 0.87);\r\n  -webkit-box-shadow: none;\r\n  box-shadow: none;\r\n}\r\nlabel {\r\n  font-size: 12px;\r\n  font-weight: 500;\r\n  margin-top: 6px;\r\n}</style>\r\n                <body><script type=\"text/javascript\">\r\nclass Token {\r\n\r\n    constructor(tokenInstance) {\r\n        this.props = tokenInstance;\r\n        this.setConfirm();\r\n    }\r\n\r\n    setConfirm() {\r\n        window.onConfirm = function() {\r\n            window.close();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let message = this.props.name + \" is a token which represents your share of the liquidity pool inside uniswap and\" +\r\n            \" entitles you to a proportional percentage of the 0.3% fee for each trade of \" + this.props.name.replace(\"Uniswap\", \"\").replace(\"V1\", \"\") + \" &amp; ETH\";\r\n        return`\r\n        &lt;div class=\"ui container\"&gt;\r\n          &lt;div class=\"ui segment\"&gt;\r\n            &lt;img src=\"data:image/png;base64,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\"&gt;\r\n            &lt;span&gt;&lt;bold&gt;&lt;h3&gt;${message}&lt;/h3&gt;&lt;/bold&gt;&lt;/span&gt;\r\n            &lt;span&gt;&lt;bold&gt;&lt;h3&gt;&lt;strong&gt;https://uniswap.exchange/add-liquidity&lt;/strong&gt;&lt;/h3&gt;&lt;/bold&gt;&lt;/span&gt;\r\n          &lt;/div&gt;\r\n        &lt;/div&gt;\r\n`;\r\n    }\r\n}\r\n\r\nweb3.tokens.dataChanged = (oldTokens, updatedTokens) =&gt; {\r\n    const currentTokenInstance = web3.tokens.data.currentInstance;\r\n    document.getElementById('root').innerHTML = new Token(currentTokenInstance).render();\r\n};\r\n\r\n</script>\r\n<div id=\"root\"/>\r\n</body>\r\n            </ts:view>\r\n        </ts:card>\r\n    </ts:cards>\r\n        <!-- placeholder for future functions -->\r\n        <ts:attribute-type name=\"symbol\" syntax=\"1.3.6.1.4.1.1466.115.121.1.26\">\r\n            <ts:origins>\r\n                <ethereum:call as=\"utf8\" function=\"symbol\">\r\n                </ethereum:call>\r\n            </ts:origins>\r\n        </ts:attribute-type>\r\n<ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\r\n<ds:SignedInfo>\r\n<ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n<ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/>\r\n<ds:Reference URI=\"\">\r\n<ds:Transforms>\r\n<ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/>\r\n<ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\r\n</ds:Transforms>\r\n<ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/>\r\n<ds:DigestValue>utEDbVcQgJPdJl8Woj8cgjEzSgLGmq2OsooCQE+xgyE=</ds:DigestValue>\r\n</ds:Reference>\r\n</ds:SignedInfo>\r\n<ds:SignatureValue>\r\nZyfUnOJRpmDtEnBv5nhuGN9Os2uA8IRFa/onp5/tNkdaHaUSp6qOyGaO+p0q40axpCJYruDuSvz+\r\nxCzKYTaHG6WKa4o3c0GhcH2r1N4o1G4RJXXWGIBt6oZfgMs8dSstaZKU36EvBhXcPoBKnqrA+dUi\r\nFbAkyYZSjdH80JlqoCXEo+ltHgfCLPHpJzetb+wYv8xeGH9e5Wpw/n6lbSmjrtYfoy3Xdw20nEz0\r\nk01+RzdWnryyW4FBGYQqvyot0/qyn0isO6wFcXQDHcllKg53I84KWkVwhZSMIqsywKUovF22Jlsr\r\nZ67VawKBdnIPewvhiTXd/Kkxj4mO8C4BddB0NA==\r\n</ds:SignatureValue>\r\n<ds:KeyInfo>\r\n<ds:KeyName>AlphaWallet</ds:KeyName>\r\n<ds:KeyValue>\r\n<ds:RSAKeyValue>\r\n<ds:Modulus>\r\ntDHBH8jKLPEjpXsy/V9/XsXBYmc64SXx6IWG9CdJzm+iSrk3Od2ZZTS3DsR5+hp9hk6UwRyb1XKG\r\n+TMrBODfxIIWricmnhxYMqiyvwDhecm4RU4YFteekBFAsuhEGCJBtmJSrle5G3iE/9FwvTfw/cxo\r\nyAydv85OWc4UkxkfjzaXVqGGKCzSFhRm48HwG51/1nmC1mmPh070EMY4Km4N/ieJZ8egLjDAIZEI\r\nEY5Cj7ig9PPnGf2pF21/z7vm3zQViXi6XJIBn1E5CTXzDW1y1BYe0QI+dxxY0o+97mwisZu7fVfB\r\n/rJJm3g7Ye4/lITkZeRMP+OLYyG1pathItlrVQ==\r\n</ds:Modulus>\r\n<ds:Exponent>AQAB</ds:Exponent>\r\n</ds:RSAKeyValue>\r\n</ds:KeyValue>\r\n<ds:X509Data>\r\n<ds:X509Certificate>\r\nMIIFUDCCBDigAwIBAgISAy095xt55U0Cc0++zYon7TT0MA0GCSqGSIb3DQEBCwUAMEoxCzAJBgNV\r\nBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQDExpMZXQncyBFbmNyeXB0IEF1\r\ndGhvcml0eSBYMzAeFw0xOTA5MjQxMTA1MTdaFw0xOTEyMjMxMTA1MTdaMBMxETAPBgNVBAMMCCou\r\nYXcuYXBwMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtDHBH8jKLPEjpXsy/V9/XsXB\r\nYmc64SXx6IWG9CdJzm+iSrk3Od2ZZTS3DsR5+hp9hk6UwRyb1XKG+TMrBODfxIIWricmnhxYMqiy\r\nvwDhecm4RU4YFteekBFAsuhEGCJBtmJSrle5G3iE/9FwvTfw/cxoyAydv85OWc4UkxkfjzaXVqGG\r\nKCzSFhRm48HwG51/1nmC1mmPh070EMY4Km4N/ieJZ8egLjDAIZEIEY5Cj7ig9PPnGf2pF21/z7vm\r\n3zQViXi6XJIBn1E5CTXzDW1y1BYe0QI+dxxY0o+97mwisZu7fVfB/rJJm3g7Ye4/lITkZeRMP+OL\r\nYyG1pathItlrVQIDAQABo4ICZTCCAmEwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF\r\nBwMBBggrBgEFBQcDAjAMBgNVHRMBAf8EAjAAMB0GA1UdDgQWBBRaKDKFkPztPgQee3418kofZddy\r\nMTAfBgNVHSMEGDAWgBSoSmpjBH3duubRObemRWXv86jsoTBvBggrBgEFBQcBAQRjMGEwLgYIKwYB\r\nBQUHMAGGImh0dHA6Ly9vY3NwLmludC14My5sZXRzZW5jcnlwdC5vcmcwLwYIKwYBBQUHMAKGI2h0\r\ndHA6Ly9jZXJ0LmludC14My5sZXRzZW5jcnlwdC5vcmcvMBsGA1UdEQQUMBKCCCouYXcuYXBwggZh\r\ndy5hcHAwTAYDVR0gBEUwQzAIBgZngQwBAgEwNwYLKwYBBAGC3xMBAQEwKDAmBggrBgEFBQcCARYa\r\naHR0cDovL2Nwcy5sZXRzZW5jcnlwdC5vcmcwggEEBgorBgEEAdZ5AgQCBIH1BIHyAPAAdwB0ftqD\r\nMa0zEJEhnM4lT0Jwwr/9XkIgCMY3NXnmEHvMVgAAAW1jKVxwAAAEAwBIMEYCIQCHuWOuAiqXC7Bn\r\nnYLS4BDrOrVeObYC7zcQvru7Aqx5DAIhAP9ukUp9nnQBWgAgTdfK+GdhHxboIaxJz7456ws6myft\r\nAHUAY/Lbzeg7zCzPC3KEJ1drM6SNYXePvXWmOLHHaFRL2I0AAAFtYyladwAABAMARjBEAiBaxydV\r\nJMY5/hQyrjaMMonJgQBhEKBHvv4FbthX+lZfpAIga4sB0hDaoT4knZfVhVP/u/Uv47t6z1+TEWnL\r\n/TresTwwDQYJKoZIhvcNAQELBQADggEBAGSPK0ivDprmvO72TVLZsuk/JDhCmXQcYe6cRGPiX7WL\r\nc0B6wfLaxb0rrQdmGpTiTEHS6wEa6tOMEsfxutPWeOxlqFPU97QHhLrdBlf4IDfk8i1Em3rpPPQu\r\n3M2u5nfeRXvsIxyB5vLQvuR/NwCQqA2bwkCrlLz7dr1iGem35DGI0ikIkdODTPI+RpwHK8b2iApA\r\nw6XaVGA99eCJS2dHqeyHPAc1Yf+Klv+z0FyM38ZUfazRRIQ17LtolM1U/9Ynld20SXtCrIFbcmbo\r\nw3piXuHLlDRcRxWqdL33yPoTEbPuLtS6vqDXefYP0RiYpQHHwJz4E6q5VCbK6LgILnIyX+M=\r\n</ds:X509Certificate>\r\n<ds:X509Certificate>\r\nMIIEkjCCA3qgAwIBAgIQCgFBQgAAAVOFc2oLheynCDANBgkqhkiG9w0BAQsFADA/MSQwIgYDVQQK\r\nExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMTDkRTVCBSb290IENBIFgzMB4X\r\nDTE2MDMxNzE2NDA0NloXDTIxMDMxNzE2NDA0NlowSjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxl\r\ndCdzIEVuY3J5cHQxIzAhBgNVBAMTGkxldCdzIEVuY3J5cHQgQXV0aG9yaXR5IFgzMIIBIjANBgkq\r\nhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnNMM8FrlLke3cl03g7NoYzDq1zUmGSXhvb418XCSL7e4\r\nS0EFq6meNQhY7LEqxGiHC6PjdeTm86dicbp5gWAf15Gan/PQeGdxyGkOlZHP/uaZ6WA8SMx+yk13\r\nEiSdRxta67nsHjcAHJyse6cF6s5K671B5TaYucv9bTyWaN8jKkKQDIZ0Z8h/pZq4UmEUEz9l6YKH\r\ny9v6Dlb2honzhT+Xhq+w3Brvaw2VFn3EK6BlspkENnWAa6xK8xuQSXgvopZPKiAlKQTGdMDQMc2P\r\nMTiVFrqoM7hD8bEfwzB/onkxEz0tNvjj/PIzark5McWvxI0NHWQWM6r6hCm21AvA2H3DkwIDAQAB\r\no4IBfTCCAXkwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8EBAMCAYYwfwYIKwYBBQUHAQEE\r\nczBxMDIGCCsGAQUFBzABhiZodHRwOi8vaXNyZy50cnVzdGlkLm9jc3AuaWRlbnRydXN0LmNvbTA7\r\nBggrBgEFBQcwAoYvaHR0cDovL2FwcHMuaWRlbnRydXN0LmNvbS9yb290cy9kc3Ryb290Y2F4My5w\r\nN2MwHwYDVR0jBBgwFoAUxKexpHsscfrb4UuQdf/EFWCFiRAwVAYDVR0gBE0wSzAIBgZngQwBAgEw\r\nPwYLKwYBBAGC3xMBAQEwMDAuBggrBgEFBQcCARYiaHR0cDovL2Nwcy5yb290LXgxLmxldHNlbmNy\r\neXB0Lm9yZzA8BgNVHR8ENTAzMDGgL6AthitodHRwOi8vY3JsLmlkZW50cnVzdC5jb20vRFNUUk9P\r\nVENBWDNDUkwuY3JsMB0GA1UdDgQWBBSoSmpjBH3duubRObemRWXv86jsoTANBgkqhkiG9w0BAQsF\r\nAAOCAQEA3TPXEfNjWDjdGBX7CVW+dla5cEilaUcne8IkCJLxWh9KEik3JHRRHGJouM2VcGfl96S8\r\nTihRzZvoroed6ti6WqEBmtzw3Wodatg+VyOeph4EYpr/1wXKtx8/wApIvJSwtmVi4MFU5aMqrSDE\r\n6ea73Mj2tcMyo5jMd6jmeWUHK8so/joWUoHOUgwuX4Po1QYz+3dszkDqMp4fklxBwXRsW10KXzPM\r\nTZ+sOPAveyxindmjkW8lGy+QsRlGPfZ+G6Z6h7mjem0Y+iWlkYcV4PIWL1iwBi8saCbGS5jN2p8M\r\n+X+Q7UNKEkROb3N6KOqkqm57TH2H3eDJAkSnh6/DNFu0Qg==\r\n</ds:X509Certificate>\r\n</ds:X509Data>\r\n</ds:KeyInfo>\r\n</ds:Signature></ts:token>"
        tokenScriptSignatureVerifier.verifyXMLSignatureViaAPI(xml: uniswapTokenTSML) { result in
            switch result {
            case .success(domain: let domain):
                XCTAssertEqual(domain, "*.aw.app")
            case .failed, .unknownCn:
                XCTFail("Unexpected TokenScript signature verification result")
            }
            expectation.fulfill()
        }
        wait(for: [expectation], timeout: 30)
    }

    func testValidatorAPIFailed() {
        let expectation = XCTestExpectation(description: "validation passes")
        let tokenScriptSignatureVerifier = TokenScriptSignatureVerifier()
        // swiftlint:disable:next line_length
        let entryTokenXMLSignedWithInvalidKey = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><ts:token xmlns:ts=\"http://tokenscript.org/2019/05/tokenscript\" xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" custodian=\"false\" xsi:schemaLocation=\"http://tokenscript.org/2019/05/tokenscript ../../schema/tokenscript.xsd\">\n  <ts:name>\n    <ts:plurals xml:lang=\"en\">\n      <ts:string quantity=\"one\">Ticket</ts:string>\n      <ts:string quantity=\"other\">Tickets</ts:string>\n    </ts:plurals>\n    <ts:plurals xml:lang=\"es\">\n      <ts:string quantity=\"one\">Boleto de admisión</ts:string>\n      <ts:string quantity=\"other\">Boleto de admisiónes</ts:string>\n    </ts:plurals>\n    <ts:plurals xml:lang=\"zh\">\n      <ts:string quantity=\"one\">入場券</ts:string>\n      <ts:string quantity=\"other\">入場券</ts:string>\n    </ts:plurals>\n  </ts:name>\n  <ts:contract interface=\"erc875\" name=\"EntryToken\">\n    <ts:address network=\"1\">0x63cCEF733a093E5Bd773b41C96D3eCE361464942</ts:address>\n    <ts:address network=\"3\">0xFB82A5a2922A249f32222316b9D1F5cbD3838678</ts:address>\n    <ts:address network=\"4\">0x7c81DF31BB2f54f03A56Ab25c952bF3Fa39bDF46</ts:address>\n    <ts:address network=\"42\">0x2B58A9403396463404c2e397DBF37c5EcCAb43e5</ts:address>\n  </ts:contract>\n  <ts:origins>\n    <!-- Define the contract which holds the token that the user will use -->\n    <ts:ethereum contract=\"EntryToken\">\n    </ts:ethereum>\n  </ts:origins>\n  <ts:selections>\n    <ts:selection id=\"expired\">\n      <ts:name>\n        <ts:plurals xml:lang=\"en\">\n          <ts:string quantity=\"one\">Expired Ticket</ts:string>\n          <ts:string quantity=\"other\">Expired Tickets</ts:string>\n        </ts:plurals>\n        <ts:string xml:lang=\"zh\">已经过期的票</ts:string>\n      </ts:name>\n      <ts:filter>expired</ts:filter>\n    </ts:selection>\n  </ts:selections>\n  <ts:cards>\n    <ts:token>\n      <style type=\"text/css\">.ts-count {\n  font-family: \"SourceSansPro\";\n  font-weight: bolder;\n  font-size: 21px;\n  color: rgb(117, 185, 67);\n}\n.ts-category {\n  font-family: \"SourceSansPro\";\n  font-weight: lighter;\n  font-size: 21px;\n  color: rgb(67, 67, 67);\n}\n.ts-venue {\n  font-family: \"SourceSansPro\";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(67, 67, 67);\n}\n.ts-date {\n  font-family: \"SourceSansPro\";\n  font-weight: bold;\n  font-size: 14px;\n  color: rgb(112, 112, 112);\n  margin-left: 7px;\n  margin-right: 7px;\n}\n.ts-time {\n  font-family: \"SourceSansPro\";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(112, 112, 112);\n}\nhtml {\n}\n\nbody {\npadding: 0px;\nmargin: 0px;\n}\n\ndiv {\nmargin: 0px;\npadding: 0px;\n}\n\n.data-icon {\nheight:16px;\nvertical-align: middle\n}\n\n.tbml-count {   font-family: \"SourceSansPro\";   font-weight: bolder;   font-size: 21px;   color: rgb(117, 185, 67); } .tbml-category {   font-family: \"SourceSansPro\";   font-weight: lighter;   font-size: 21px;   color: rgb(67, 67, 67); } .tbml-venue {   font-family: \"SourceSansPro\";   font-weight: lighter;   font-size: 16px;   color: rgb(67, 67, 67); } .tbml-date {   font-family: \"SourceSansPro\";   font-weight: bold;   font-size: 14px;   color: rgb(112, 112, 112);   margin-left: 7px;   margin-right: 7px; } .tbml-time {   font-family: \"SourceSansPro\";   font-weight: lighter;   font-size: 16px;   color: rgb(112, 112, 112); }    html {    }        body {    padding: 0px;    margin: 0px;    }        div {    margin: 0px;    padding: 0px;    }     .data-icon {    height:16px;    vertical-align: middle    } \n\n\n</style>\n      <ts:view-iconified xml:lang=\"en\">\n        <div>\n    <!-- Iconified view displayed on the first page when clicking on token card in AlphaWallet -->\n    <p>Enter Satoshi's villa with this special token!\n        <img alt=\"\" src=\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QCMRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAMigAwAEAAAAAQAAAIcAAAAA/+0AOFBob3Rvc2hvcCAzLjAAOEJJTQQEAAAAAAAAOEJJTQQlAAAAAAAQ1B2M2Y8AsgTpgAmY7PhCfv/AABEIAIcAyAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/3QAEAA3/2gAMAwEAAhEDEQA/AOaxmlx707GKCtfr9z45Ow3oasW555qDB+tPSTBweDSlqjVWZdkX5QSuR61DirFvKvG7kVOyxM4K7R6gisOa2jJlC+xBbxBz1xj1q3NZMV/dj5uvHeiRIQpZBg+xp0GpeVweaylKT1iUodGVvsc6rnymKkdcVErADG0Ee9an9pA5w2M1VmMbPuxyfSiMpP4kJ07bFbbnJ24FRYI4q7HC0z7U4B9aZJaSxvtdDn17VamtjNxZV20basm2kDEbSfpTXiZDhlINVzJk2ZBijbUm2lK4p3AhxRipNtGKLiGYo21IMijbSuBHijbUoQmniOjmEQbTShKn2UgWlzCEVKdtpyrT8VNyT//Q55WXGCD9adtHZhUYFLX68z48l20mwN1FRnd60b3UUrdh2J1UqeDxTmlwOKriU9waer7zgDik49x3BrhvWo95bvipfKU9qVYFHvTvFBzjI2YHJq3HIVOcVGUyAPSpASBWcmmHOWYb3yz93H4VK2o7up61QIGcsevHWq9zeWdorm4nhh2/89XCZ9MZrCfsoe9N2NIuUtIo1vtpP3f5Uzz2brWP9vlmhSXT7G7uMEb18vaAP95iB+PIpYINVurvdLNb6ZARtwUa5Y+4A2gH6bvpXDLMcP8A8u/e9Nf+Bfyvc3+q1XrL3fX+vxNIEOSVIIzg47Gs6TWbCPCy3KLNyPJ+9JkdRtGSarvodr57/b7+8vJGO4os21W99kYAP41q2ukRWttP9i05II0T5iqLEQMZ5B5P0rzsTnfslvGL7N6v5Lr5XOqjlTm9m/RaL5vp52KOm39zdFFfT50To9wxVUz2wud3P04zWntzU+nkjS7iI8CVsAiPc6sBkFT2569iOKr3NhPpsEN1Kbh3Vc3KytuO091AwBjr05Ga48LxNTg1SxF3Jvfokb1sjnNOpRta23VscI6kEdSgAgFSCp5BHQ0bc9K+r5r7HzrTQwKKXFPJVfvED6nFIkkchIRwxHXFZutBS5W1capza5knYYVpMVKRSYq7kWGqKXFOAoxSuFj/0ecAOKUVXSQenP1qZTnpX7A1Y+RsShTjvS4zxTF+lKfl5JNQFh+31pVAHSiNkP8AF+YqTAPIZSO9S3YXKNyexpcnGcUyaQRJub6ADvVeTU7S3wZZ1jU924Fc1TFUacuWckn5s1hRnNXjFtF4HjmmmC4uZYYbJo0ld9u6UEqPwHX8xWfHrmmyn91dKw7uFJX6bsYB9q19DurefUrXyZ4pMSAnYwbA/CvPzLGwjhKk6M1zJdGjpweHk8RGNSOhmz6HdNPJb6jqTsA3zR2qhE/M5Yfgwq9p1lbWMR8m1Kys+wyM4eQZ7ncGLAj0NS31y8muX8ckMkQEx8stwJBgcj9eOtenfD2Xw9N4XhuLwWstysriJy27JBI9s4r5PN6saWCp4qjO8nZO+vRvrtr08z3cFrXlRqQ0W1tOtv6ZwNgrJFqYG13CcbeA3J6ZH9K2bTwlqeo2ZubC0aWC4XBhdi2wgkZxwBVfT7GDVNZvbG8Qy213K0UiAld6lm4yOfyrtbDxLFocnlorDKlBu3EDGB3/AAr5XFVat1Zuz3t/loj2KNrWildbX9e5yniDRJNA0kpctuktFDrFBtDlumB05571yUsmstcES+H54oigaS4uZ8siEkZ2jHce9db4m8TG5NxLdQRxQYVgfMXLkMDgKOvAOB1q1fzS3dhqU9x5SBbcIFiOc/vBtyc+jD8jXHT9pTcfd3f6nTUleLuzS+FMejTeeNUjQzRkSRlzxnp+Jqt408qTWJDAAI9oAx9TXKaJdGCK4KvgkYxnrWjHK9wGeRtxyAPpivSlTtiOZ7W/M5aWtO6OTnivrDWIILbb/ZnJKkfdHdc+2ePars6mRsqzgY6ZxV3Uona5UAhRtqIWmR80tdss1rKj9XcvdX3+hEcupOr7dR1f3GesSg8gfjVqzA818Efd/rQ9qgI/eE+vFSWsSRuxTdyO9a5RWTxtP1M80pNYSp6ErUzFSNSMpUAngGv0o+AsxoFLTdw4yaNw/vCnYLH/0uNVp+4/OpIjKp6LW1FYQbyrI3H+2az9Otp9SnmTT4ZJVhuDbO/UK+N2D36d6/S4ZzhnfnfKu7PnnhKv2Vd+QqyMQAwXPsKerZ6qCaS9tpYBtRw0gOD0AGD0yTTYhK2S6Kg9fMU5PTArR5nhU7c34MlYSq1e35DpP9W2AAccVj3OhT3Kgzavd5HJQBVT8gB/OtWR9sBZ8LngDcDn8qpmScrndgeuK83G4zDVJr2krws9NVrf5HRQo1YxfKrSv5GZrumJFqFv9nDw2rxxhoocgEscMc/iKgn8O2yXVxhH8sHCFpCx/Mmum1KJJVjJnjVlRTtJ54waqzI4kKSZRifutwfyPNfHrkl1/M9x8y6GabU2vhLUIY18whg6q54J3ZFaXgaPyDBcSxJFM0aNIFHGcnIqaOIfYpo2OckHkV0/gHwvJq6Xs0M9ukNoimUZwQOeg/DFY1ZU4U5OTKgpOasiKe4uHvpdm0W8gOTnnJPaiNrjY/mvGcklSkQyp9cnPtSazdWmmX5tZjIZRyUXAIH41qeHWtb4pIqS+STjD4z+leZiK0I0lOa93podtGnJ1HGL1Kel3txp97DdQkSTxuHDOOrDuQPrTdWuX1F2a6SPBfftA4Br0jVfCml6bYC6tZftE1xjyogQNvHP+Fc4NFjQBrpHWUjLRnjYcdDiuSrmNGD99G1HCVKmsGcfnMQiwPLAAC4wODmppxdSRkmSVkwARuOMDpxXVXFhFHag2lpbS3DyJEizMVXLMF5PbrVrQ7a4sdbjj1SytIrfA3rFKSepHyjnJyp49OazWZ05K8I/kaSwE1fnkcdo8Ia4IdQRg8H8K0r6aPR4Q7QXUschzmKPeF7cnt+Ndv4ysNDtb2zTSoI13iZpAM4z8uPyo0Kxtp9CvppZD5sLhUU88EU6+OvO0VfTvoXh6CVNSl3PNdQ1bb5Up0u+ZWGUyEG4f3h83SqreIwo+TS5hlto3yIua9Nm8O2KRW88tvbSGdN4BGSOcc/lSLo2nJgrY2oI/wCmS/4V51THRUrOJ6EKSa0Z5XJr17IH8rTrcbTg77nH/stFzday8vlwrpsakAiR5WK7e59yPTqfavWI9Ntdw228I+iAVT8aeHvsgsZS0S+ap+ReCOnWuvLsbJ11Kn7rWt+xy46nD2bhLW/Q8Zm1zULe4kSeW3lAGFEaFcH1JJP5Vm3viW5KMDclGx8oVCRmup+I3g8eHo453vreYyL5uInzwecEV53NiSH57i2PcK7CMKM+lff084nKglTm2+76/wBdD5Gpgoqo24pLsi0viG7AIE8xc9OAB+tL/wAJBqX/AD0k/Jf8KxpJLYPvklhMkednzcDio/7SH/PW2/7+VyvG4lvWo/vL9jSX2T//0+OTxtZO2RBc8nG35ev506y8aW8MLRz2Vy7ebuQwSiPC89ecluevtXniHauzJLdCwbGKuQxTTxs6jbHGMEd2/St5YmpJWvb00MowSd0v1OkvfEzSXDNFAgiYcB13MDzjJz/SqUWs3qWoT/Rzht2TCR+fNZD+YOBG4BIy23NSoLi4TYLZyf4uMZ/Oh4uq/tC9kuxdhv5JGSSSWSTdgkfw8f3fSrommvdejksfNELAK8ZGSBg5Pp1xWPbpOHXFu+Adu0dP8iun8PaaULz3DODyEVcdPel7eTklI0jTfRFq7sRLqRlkiDMLYBCVyQwBx/OsXxtZzXmv3E4iaTcFZXxxnA6E9Ogrr7hrOJFMz9AAMkD+lTrp1rd6UZwQbgFMbmznp29qz9nGUrJ7nU5S5eZo53Eh0NRO7RytFHvYnnjr/Wtb4Z3DabrWoLbrsguljTpjcA57fjmobjSpjHhRlVUgKi+3bmjwzBdWF2brULfyVyu3J+YgEE5qcTRUotPUKVVproJ4/sZ7jx7dXcEHmLBHGjOMZXcuAPxNb/g+byNPjWX5H8xlwxwc5qtrUC6hqt3eWd3sNwFUhoycbQMeo6gGshLLWAXQ3FnIjuXJk+XnHX7vGa82rGVTDqi1orfkd1FxhWdS+9/zPVLLV3nvWjkclIxu6+h/wpJ9Uiv5pJ7dxJE+HUr0wRXKaPfRw3L+dKmTEVzngn2rIk029S6SbS3iiiiRI0gjYsG29+DivPxWCi5K2mh2YSv1kztdQugltCSRxd2xIP8A13Spdc1K2hjtxLva4kgJh2dFZZGzn8Grlhp+pybtwjLySQnDRkgYcHOQe2B/hWfrFjq0WoW811c2nkRFwVWVy7Ak8lSuBzg9fSscPh0pxTfU6MRONpNa6HR2+oPc36GR8hVf9cV0Oh3uIbmLnazA5/CvOrJ2lvEVeSQ/f/ZJrptJvorSVopnAdl3cZYYwPT6V1YvDrmtFdDmw1W8PefU6ttRZUiRo2JHyrk49TT5NQKR7mhOB1+b/wCtXM3V7ZtLGwvmJ+XIAYAfN7/Wpba/tzp5AvE3gscOx59O1edLBSfvcv5nYq0NrnRxXjM64i6+jZrE8Y3zSS2uGb5QRye/FQRX0D367tQiVBnAD8fdH071m+J5o5BFJFcRTgM2TGenTGfyrry/DOniE2uhzYupGdN2Z53qfhvVNWmnaTWI1RpGKo0bHAzkD71ZFz4OltATLqluw6bBC2eB67uK6UtdCd4STEhy+Q2e5xj2IpL3TlkfEl0JvMGQUbcue6sOo69K9P2lWL30PBm1HXc4E+HoBP5b6lHGQAcmFj9OM81N/wAI3bf9BiH/AMBX/wAauavJarfDfdL5gYo6IAdp7befbHNQeZZ/8/dz/wCO1uqkmr3/AK+4wTctUj//1PEIREpULCGOOh9a3La/vzGI7bT2ORjIRjn9K7jSUt7qESWsSLF6qACD6Edq0ZLFJIzHICVPUZIrvjgo2vzXMVUn0POIbXWsH/RljUnrJgAD8TWzaWD3EDrLelJ2jIItlVm3A5zxnjAIroU0YW1wJ7Pyiw/gnQOD+JFaNxrl0kMMM1pHGU6FMoCcnkY4/WtKWFpqVn+P/AObE4ivTV4Q5vn+hzsfhm41BZI7e31KZmcSqhVouQoQ4JC8Y5I6Z5rW0/wkNJUf2jFcWjyLny1xKwX1++e/HSrcviO8ll3Kwjk6DCYIGO2apy3FzdzCWaaQuBtDFugznH6V6lPJ+dXTXyPAq59WUuVwt6nS6XoGl3qbok1W9xxiOEgA+nC/1rTn8IDyCYNPv4pcfK9xdrGq/gMk/jWRpfibUNN0uOyhuAI1LNnbycnP0pt9q9zcsfNuJZMjkFjj8qyWVVObWWgp57K1orUWfSJrBGM+rQRsATsGJP6CsUWcF8+JksLgn++joc/g39KsNl1bgD6Utjp0tzI7Iu4RrvY46AHrWs8soKDdRmVLOMZKaUX8rJkF7oFhDIY0sQyhRkwXJTGewDCqX9i2i8B9atsd1dXA/I1panBKL8lGdcgcg/0qSzFwv3n3c/xL1rgqZNTVNTTPRp55WdRwlFP70Za6DKCrW+sahtcEoslq/OOvPNRvbTk4g1fT5n/uysq4+oK5roLW7mivmzH8vPKmtG4FlJMxlgR4z03KCCPyrgq5e6bs2enRzdTjfk/E4n+zvEQGYo9NuAP+eZU/yxVW8i8SLCyS6TkYxlM4H4BjXeDS9BlZXNjbZDDOz5e49KsX3h/T3YtayXFqqgtthuGGBnHeuZ0JJ2udUcwptN6o8huX8QQyAx2s8XY7Ubn9Kh/4SLxFBgvcXAI/vKn/ALMten3Fi0ETLBqt4r9QzsDgfQg1WgGqPFJsu4ZQgy3n26n+WKqVColdoqni6U9IzPO7fxjqq3KNe7ZYh97dAhz/AN84710+neKLKdNklmME/eglKnJ/2TV67S9bb5mn6VcsRwFTaeuMHk1QutAbIa58OW0fT5oZxlR64wMYrKVGzXM0jspVpP4XzGlAbG8mDW995I9Lhfb1FWptKu9jPF5VwuODBKG/Q4NYsehG2YvZtIFxjbu3D8jzVQ/bLRvkY4H93gj8Kp0qkdtTRVU9yS6EsUrJcRujDGQwIxVPUZnudODQ3BhuD8jvs3Y9MjHII9jxW7p16dTsLhLjLSI+CSMEjHB/DJFU9btkuY7W3t2Fu/TeFBBI5GR6ev14qI0HbmKqVYy0scRbaRYX0sttNbfY7pdu5ouVAJxuQHp04AyO49Kuf8IRpn/QX1H/AL9L/hU+nsPPcv8AJcJJtkiJGUOcn8/UdepGeTteaP7w/WrhDTU5pOzP/9XyeyvdZsrl7y3triIfxs0DKpHvkAYrufD2vnVCqPKkVxj/AFbHIb/dNcpd+ONYurh4o0trWLHWPMrDPTk8Z9sVz9zqMn2gzM7vIeSQqrk/RcAVtTxDo6Qd0ZOJ7ccfjTGxgqQCD1BGQa840DxnLGRFfBmBwBMSSyj0I9K7SDUBLGrgq6NyGQ8GvVoSVaN4/cRKSRNNZxOPkOz/AGSMr+Xb8Kz5o54WIUkgDofmX8+orTWQOMqTRuI6HFdVNzpO8HZnPWo0q6tUimZhn+6XUpgfe6r+dWUkYjcOVPcHIqSWJHzxsf1Xj9OlUpLV4yWjJz6x8H8RXbTx7WlVf1/XoeNiMjhLWjK3k/6v+ZpRS/KwrY0TVbnTxOLUqBOnlyZXOV9PauUiupFPzoJQOpX5WH4dP5Vr2V1A+1RIEZuQr8E1rUlQrQcW9+jPMeExOFkpW26o2ImUybmQMf8Aa5q1BDHczosknlKTgtsLBR64FUQQvByKvWYOzfuUAHHJ5P0rirU7LmCnN3sbt74dht9LtrtJY5Wk4ZVPK/hWNPaBQNvCj0p0l2y5SPv1bvT7aOWU8ZNcMac4L35XO6VWM5XhGxRktfMjKbM56EioLm01Lym2zZUoUwOOK7XRrIJMsl7AksGDlWfbnjjmrcOk20sgA3Pk9EBNc8sQovb9TphBtaPc8nkttRifl+Np6qD2qxo2p2VroGtx3+43kgQWxQcAg5Ib0Fet+IfC1k0SPaouCPmLtjBrxzxJo6wSzpFIgVDkKTjcewFXGrRxcff93/gM3jGphZ8sVd/5on8IQy3sz312THCq/uUc4Dnsc+gxmt/xTNFb28EEbhpZOZMjnj054BPb2rK0e9NjpsVs4DxL8oGc4J7gGs/UZ4pr1jFkpngtjPHX9a8d05YnFc8tlt6dD6aio4fD8sd3v6lu2fsQDj1p1zBDcIRIit1+oqnHJjPcVJ54wR1x7101KbvdCjPSzMgqunajHIpby3+Vs84BqW/tUM6SjdujORg9RVbXLhUVt7fL6kZqeyuWubJGxl0+R8/pRRdpWl1Jqaq6M3WLeHKXaxr5xKxmQcFh1AP0qnv+tXdbbbDH8p5kHbis7d7CrqRSloYq7P/W8BiWWZ9kZeSRuSigkn8BXQ6d4W1K6UGZUtU9ZOT+Q/xFd/aWVvZJstYI4V/2VxT7q4htoWluJY4ol5LOwAFd1PCR3kzmc2zBsfB+nwLm6aS6cnOXO0D2wO31zW3a2MNooWwRLcLzsA+VvqP61y+qeN7SHK6bE92/98/JH+fU/gK5DU9f1fUbgLPcOsWQwjh+Rfx7n8Tj2rR1aNLSO/8AXUFCT3PX4LpWbymaNZgMlFcH8RVjd6ZNeI2U7WUwltv3Mn95eCTXeaB4uSbbBqeFmzhZAMBvr6VtQxsZvlnoxSjbY7HPvx7UAj6fSqsdwsyho3Uqe6ng0GQg8HH8q9FRbMuaxYljSQfOoz69/wA6qTWpPTDr/dapklx97rUmc85x/Ks5UuhSkU1uLi1fEM7xr2jf5l/I/wBMV0uheI5IYJFm2QyMyocDcHHXOCOOQOmTzWG+CMHgfTIpkaGCUSQkq69CDkCspxnycqZlLDUpy5mrPutGdnZX9lcSt5dxG0mclAfmH4Hmum0RVvrqKJXjt1c4Mjdq8buIyTmRAwHQr2rZ8P6rfWol8u58yKKMv5c+XHHYHqOvrXNWbcNdGc6y/lneDuuz/wAz1+3sglw/nyb0Q8MTwa6HTSHBEAEcfeQivHLDx+C6rqlpJGo/jgO9fy4b8s10a+NrC7ZYLK8j8pRufJ2n6bTzXDOlUloJR9k7tWR6FrN5Z6bYiaWVFRjgH70jn2BrwnW7lNb1ae8iMhiiJCnORu6E/h0H407xf4mn1a8+yW8mwyqVjP8AzzToWz69h7n2rNs1+xQlY1A2AALnoB0qXSlSVup6GESqv2rWnT/MZfFlAVMhWwAagR8NjsOKsXVwtxJgchOuBgA1WXpk9+ea7MHG65mdVV62RZhkwDjpmpGIYsVwDgGqUZKqD2NSbju46YqqsNbhCRBd8yqGHBG04rP0mf7LqRiY/u5flPsfX/PrV65YnB7jmsjUlCzb14yNwI9a5Jxa1RrFnRXdusiMkiBlPaqH9mWv/PFv+/jf41fs5xeWSSZy6/K/1FP2/wCyK6YuNRKRjJOLsf/X8s1PxvPcIw0m3WKM9Jp+SR6hR/U/hXK3s895IJr64luHzwZDnH0HQfgKgs/+PBP9z+lPk/1afUfzp1K05uzZmkk9BhQjO3JwecnvSwY2M7E7jyaePuv/ALxqOH/Ut9DUIb2JS+3pw1Rlm3DJ5ok/1p/Gkb761SJOl8OeIpLICGZWlgOABnlPpXfwTrPEsiHKN04ryG1+8v1r1PR/+QdD9K9nLaspXg3ojCqktS+OB8v5Ub8dDyO1IOo+lNP3n+teuYEscm9sdDUpYJjIx6Y71Wg/134VPcdE+tYyVmaRd0K4z8zj8R2pjBsMqnhhz2yKll/1R+lMX73/AAEVk4qS1KvYovG3PlvkD+FhTY4oZ2/eIVKZO4c4NTj7z/WoYOsv41y1lyrQ0hq9RbK1VHkkXJ+6rMxJOOcDn8a0JJ0WNtwzgZqCz/1E/wDvL/M025/1cn+7/jXFV1ub09LJCwjbbhieX+Y/jTmbC5H6Ui/8esX+6v8AKkP3D9K7aCtEzm7sWI5UY/HtQzYkXnn3ot+h/Cmy/wCuX8aUxxYk7A4zxWffput8kfc/Grtx90VWvf8Aj1lrlnuapieG7rZcNCzZWTjp3A610uE9647Qf+QhH/v/ANK7CuPnlDRG3Kpas//Z\"/>\n    </p>\n</div>\n\n      </ts:view-iconified>\n      <ts:view xml:lang=\"en\">\n        <script type=\"text/javascript\">\n    (function() {\n        'use strict'\n        function GeneralizedTime(generalizedTime) {\n            this.rawData = generalizedTime;\n        }\n\n        GeneralizedTime.prototype.getYear = function () {\n            return parseInt(this.rawData.substring(0, 4), 10);\n        };\n\n        GeneralizedTime.prototype.getMonth = function () {\n            return parseInt(this.rawData.substring(4, 6), 10) - 1;\n        };\n\n        GeneralizedTime.prototype.getDay = function () {\n            return parseInt(this.rawData.substring(6, 8), 10)\n        };\n\n        GeneralizedTime.prototype.getHours = function () {\n            return parseInt(this.rawData.substring(8, 10), 10)\n        };\n\n        GeneralizedTime.prototype.getMinutes = function () {\n            var minutes = parseInt(this.rawData.substring(10, 12), 10)\n            if (minutes) return minutes\n            return 0\n        };\n\n        GeneralizedTime.prototype.getSeconds = function () {\n            var seconds = parseInt(this.rawData.substring(12, 14), 10)\n            if (seconds) return seconds\n            return 0\n        };\n\n        GeneralizedTime.prototype.getMilliseconds = function () {\n            var startIdx\n            if (time.indexOf('.') !== -1) {\n                startIdx = this.rawData.indexOf('.') + 1\n            } else if (time.indexOf(',') !== -1) {\n                startIdx = this.rawData.indexOf(',') + 1\n            } else {\n                return 0\n            }\n\n            var stopIdx = time.length - 1\n            var fraction = '0' + '.' + time.substring(startIdx, stopIdx)\n            var ms = parseFloat(fraction) * 1000\n            return ms\n        };\n\n        GeneralizedTime.prototype.getTimeZone = function () {\n            let time = this.rawData;\n            var length = time.length\n            var symbolIdx\n            if (time.charAt(length - 1 ) === 'Z'){\n                return 0\n            }\n            if (time.indexOf('+') !== -1) {\n                symbolIdx = time.indexOf('+')\n            } else if (time.indexOf('-') !== -1) {\n                symbolIdx = time.indexOf('-')\n            } else {\n                return NaN\n            }\n            var minutes = time.substring(symbolIdx + 2)\n            var hours = time.substring(symbolIdx + 1, symbolIdx + 2)\n            var one = (time.charAt(symbolIdx) === '+') ? 1 : -1\n            var intHr = one * parseInt(hours, 10) * 60 * 60 * 1000\n            var intMin = one * parseInt(minutes, 10) * 60 * 1000\n            var ms = minutes ? intHr + intMin : intHr\n            return ms\n        };\n\n        if (typeof exports === 'object') {\n            module.exports = GeneralizedTime\n        } else if (typeof define === 'function') {\n            define(GeneralizedTime)\n        } else {\n            window.GeneralizedTime = GeneralizedTime\n        }\n    }())\n</script>\n<script type=\"text/javascript\">\nclass Token {\n    constructor(tokenInstance) {\n        this.props = tokenInstance;\n    }\n\n    formatGeneralizedTimeToDate(str) {\n        const d = new GeneralizedTime(str);\n        return new Date(d.getYear(), d.getMonth(), d.getDay(), d.getHours(), d.getMinutes(), d.getSeconds()).toLocaleDateString();\n    }\n\n    formatGeneralizedTimeToTime(str) {\n        const d = new GeneralizedTime(str);\n        return new Date(d.getYear(), d.getMonth(), d.getDay(), d.getHours(), d.getMinutes(), d.getSeconds()).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});\n    }\n\n    render() {\n        let time;\n        let date;\n        if (this.props.time == null) {\n            time = \"\";\n            date = \"\";\n        } else {\n            time = this.formatGeneralizedTimeToTime(this.props.time.generalizedTime);\n            date = this.props.time == null ? \"\": this.formatGeneralizedTimeToDate(this.props.time.generalizedTime);\n        }\n        return `&lt;div&gt;\n            &lt;div&gt;\n                &lt;span class=\"ts-count\"&gt;x${this.props._count}&lt;/span&gt;  &lt;span class=\"ts-category\"&gt;${this.props.name}&lt;/span&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                &lt;span class=\"ts-venue\"&gt;${this.props.building}&lt;/span&gt;\n            &lt;/div&gt;\n                &lt;div style=\"margin: 0px; padding:0px; clear: both; height: 6px\"&gt;\n                &amp;nbsp;\n                &lt;/div&gt;\n            &lt;div&gt;\n                &lt;img src=\"data:image/png;base64,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\" class=\"data-icon\"/&gt;\n                &lt;span class=\"ts-date\"&gt;${date}&lt;/span&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                &lt;span class=\"ts-time\"&gt;${time}, ${this.props.locality}&lt;/span&gt;\n            &lt;/div&gt;\n            &lt;/div&gt;`;\n    }\n}\n\nweb3.tokens.dataChanged = (oldTokens, updatedTokens) =&gt; {\n    const currentTokenInstance = web3.tokens.data.currentInstance;\n    document.getElementById('root').innerHTML = new Token(currentTokenInstance).render();\n};\n\n</script>\n<div id=\"root\"/>\n\n      </ts:view>\n    </ts:token-card>\n    <ts:action>\n      <!-- this action is of the model confirm-back.\n      It should be <ts:action model=\"confirm-back\"> but Weiwu\n      shied away from specifying that due to the likely change of design causing an upgrade path issue.\n      window.onConfirm is called if user hit \"confirm\";\n      window.close() causes the back button to be pressed.\n      -->\n      <ts:name>\n        <ts:string xml:lang=\"en\">Enter</ts:string>\n        <ts:string xml:lang=\"zh\">入場</ts:string>\n        <ts:string xml:lang=\"es\">Entrar</ts:string>\n      </ts:name>\n      <ts:exclude selection=\"expired\"/>\n      <style type=\"text/css\">.ts-count {\n  font-family: \"SourceSansPro\";\n  font-weight: bolder;\n  font-size: 21px;\n  color: rgb(117, 185, 67);\n}\n.ts-category {\n  font-family: \"SourceSansPro\";\n  font-weight: lighter;\n  font-size: 21px;\n  color: rgb(67, 67, 67);\n}\n.ts-venue {\n  font-family: \"SourceSansPro\";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(67, 67, 67);\n}\n.ts-date {\n  font-family: \"SourceSansPro\";\n  font-weight: bold;\n  font-size: 14px;\n  color: rgb(112, 112, 112);\n  margin-left: 7px;\n  margin-right: 7px;\n}\n.ts-time {\n  font-family: \"SourceSansPro\";\n  font-weight: lighter;\n  font-size: 16px;\n  color: rgb(112, 112, 112);\n}\nhtml {\n}\n\nbody {\npadding: 0px;\nmargin: 0px;\n}\n\ndiv {\nmargin: 0px;\npadding: 0px;\n}\n\n.data-icon {\nheight:16px;\nvertical-align: middle\n}\n\n.tbml-count {   font-family: \"SourceSansPro\";   font-weight: bolder;   font-size: 21px;   color: rgb(117, 185, 67); } .tbml-category {   font-family: \"SourceSansPro\";   font-weight: lighter;   font-size: 21px;   color: rgb(67, 67, 67); } .tbml-venue {   font-family: \"SourceSansPro\";   font-weight: lighter;   font-size: 16px;   color: rgb(67, 67, 67); } .tbml-date {   font-family: \"SourceSansPro\";   font-weight: bold;   font-size: 14px;   color: rgb(112, 112, 112);   margin-left: 7px;   margin-right: 7px; } .tbml-time {   font-family: \"SourceSansPro\";   font-weight: lighter;   font-size: 16px;   color: rgb(112, 112, 112); }    html {    }        body {    padding: 0px;    margin: 0px;    }        div {    margin: 0px;    padding: 0px;    }     .data-icon {    height:16px;    vertical-align: middle    } \n\n\n</style>\n      <ts:view xml:lang=\"en\">\n        <script type=\"text/javascript\">\nclass Token {\n    constructor(tokenInstance) {\n        this.props = tokenInstance\n        document.getElementById(\"contractAddress\").value = this.props.EntryToken;\n    }\n}\n\nweb3.tokens.dataChanged = (oldTokens, updatedTokens) =&gt; {\n    const currentTokenInstance = web3.tokens.data.currentInstance;\n    document.getElementById('root').innerHTML = new Token(currentTokenInstance).render();\n};\n\n</script>\n<script type=\"text/javascript\">\n    document.addEventListener(\"DOMContentLoaded\", function() {\n        window.onload = function startup() {\n            // 1. call API to fetch challenge\n            fetch('http://stormbird.duckdns.org:8080/api/getChallenge')\n                .then(function (response) {\n                    return response.text()\n                })\n                .then(function (response) {\n                    document.getElementById('msg').innerHTML = 'Challenge: ' + response\n                    window.challenge = response\n                })\n        }\n\n        window.onConfirm = function onConfirm(signature) {\n            if (window.challenge === undefined || window.challenge.length == 0) return\n            const challenge = window.challenge\n            document.getElementById('status').innerHTML = 'Wait for signature...'\n            // 2. sign challenge to generate response\n            web3.personal.sign({ data: challenge }, function (error, value) {\n                if (error != null) {\n                    document.getElementById('status').innerHTML = error\n                    window.onload();\n                    return\n                }\n\n                document.getElementById('status').innerHTML = 'Verifying credentials ...'\n                // 3. open door\n                let contractAddress = document.getElementById(\"contractAddress\").textContent;\n                fetch(`http://stormbird.duckdns.org:8080/api/checkSignature?contract=${contractAddress}&amp;challenge=${challenge}&amp;sig=${value}`)\n                    .then(function (response) {\n                        return response.text()\n                    })\n                    .then(function (response) {\n                        if (response == \"pass\") {\n                            document.getElementById('status').innerHTML = 'Entrance granted!'\n                            window.close()\n                        } else {\n                            document.getElementById('status').innerHTML = 'Failed with: ' + response\n                        }\n                    })\n            });\n            window.challenge = '';\n            document.getElementById('msg').innerHTML = '';\n        }\n    })\n</script>\n<h3>Welcome to Craig Wright's house!</h3>\n<div id=\"msg\">Preparing to unlock the entrance door.</div>\n<div id=\"contractAddress\"/>\n<div id=\"status\"/>\n\n      </ts:view>\n    </ts:action>\n  </ts:cards>\n  <ts:attribute-types>\n    <ts:attribute-type id=\"locality\" syntax=\"1.3.6.1.4.1.1466.115.121.1.15\">\n      <ts:origins>\n        <ts:ethereum as=\"utf8\" contract=\"EntryToken\" function=\"getLocality\">\n            <ts:data>\n              <ts:uint256 ref=\"tokenId\"/>\n            </ts:data>\n        </ts:ethereum>\n      </ts:origins>\n\n    </ts:attribute-type>\n    <ts:attribute-type id=\"time\" syntax=\"1.3.6.1.4.1.1466.115.121.1.24\">\n      <ts:name>\n        <ts:string xml:lang=\"en\">Time</ts:string>\n        <ts:string xml:lang=\"zh\">时间</ts:string>\n      </ts:name>\n      <ts:origins>\n        <ts:token-id as=\"utf8\" bitmask=\"0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0000000000000000000000\"/>\n      </ts:origins>\n    </ts:attribute-type>\n    <ts:attribute-type id=\"expired\" syntax=\"1.3.6.1.4.1.1466.115.121.1.7\"> <!-- boolean -->\n      <ts:origins>\n        <ts:ethereum as=\"bool\" contract=\"EntryToken\" function=\"isExpired\">\n          <ts:data>\n            <ts:uint256 ref=\"tokenId\"/>\n          </ts:data>\n        </ts:ethereum>\n      </ts:origins>\n    </ts:attribute-type>\n    <ts:attribute-type id=\"street\" syntax=\"1.3.6.1.4.1.1466.115.121.1.15\"> <!-- string -->\n      <ts:origins>\n        <ts:ethereum as=\"utf8\" contract=\"EntryToken\" function=\"getStreet\">\n          <ts:data>\n            <ts:uint256 ref=\"tokenId\"/>\n          </ts:data>\n        </ts:ethereum>\n      </ts:origins>\n    </ts:attribute-type>\n    <ts:attribute-type id=\"building\" syntax=\"1.3.6.1.4.1.1466.115.121.1.15\"> <!-- string -->\n      <ts:origins>\n        <ts:ethereum as=\"utf8\" contract=\"EntryToken\" function=\"getBuildingName\">\n          <ts:data>\n            <ts:uint256 ref=\"tokenId\"/>\n          </ts:data>\n        </ts:ethereum>\n      </ts:origins>\n    </ts:attribute-type>\n    <ts:attribute-type id=\"state\" syntax=\"1.3.6.1.4.1.1466.115.121.1.15\"> <!-- string -->\n      <ts:origins>\n        <ts:ethereum as=\"utf8\" contract=\"EntryToken\" function=\"getState\">\n          <ts:data>\n            <ts:uint256 ref=\"tokenId\"/>\n          </ts:data>\n        </ts:ethereum>\n      </ts:origins>\n    </ts:attribute-type>\n</ts:attribute-types>\n<ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\">\n<ds:SignedInfo>\n<ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n<ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/>\n<ds:Reference URI=\"\">\n<ds:Transforms>\n<ds:Transform Algorithm=\"http://www.w3.org/2000/09/xmldsig#enveloped-signature\"/>\n<ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"/>\n</ds:Transforms>\n<ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/>\n<ds:DigestValue>z+I6NxdALVtlc3TuUo2QEeV9rwyAmKB4UtQWkTLQhpE=</ds:DigestValue>\n</ds:Reference>\n</ds:SignedInfo>\n<ds:SignatureValue>\nE9H57w4vE8dP/7gZYMLm4z+AohkuIWgvqiGfCnMmy87T25Q1utzlFHE71isNvdkBooBHKnFaLm4X\n7HRSdjNyNt8UIqp8ekJZt4zK/GyUZ9Fk290A4Bey6YEko2atQSCq1wRKRbbhbyT1rggYdSVfGc85\nbQ2fnLzLETITeo5Cbp6ShcWUhdPqCSSFOoIKoIpIJG/lXNa/IFUWtBs07K6S5G77O/mPXkugzpjw\nASDyefe7Z2FPgHyebrOkyDHaS3ycnqJB11r0I4ve5j9cVsjarxfRzyGzbZri/qvbr7ov3J0HDXyl\nIQ/01ct32V6UIXlqPgsk12IcqtY16BwQalIx0A==\n</ds:SignatureValue>\n<ds:KeyInfo>\n<ds:KeyName>Shong Wang</ds:KeyName>\n<ds:KeyValue>\n<ds:RSAKeyValue>\n<ds:Modulus>\nql1jleB5eU+FiIK50QwMc1pS6ieMxqciwdYHdOalEyLZZ0Swt+3Ls24g1Ktar+aJJjSJO8OjUNse\nBqECPSP2rGYIfNN7echgXEJtr9MZ5vz/G+zEyZB4lfJaBb3iGreQerdgktcjla6PC/bSiFrWs9zA\ntMp1uowMWV2T5LY7N1SYw6uLP3c8CYog7u14zwHrVgWt8MeKfgSznXyVb3A9REYo7qqnAsJq4zfR\nUfM1KQeobcLZVaPSafK6BRn0tGDoxX76ffwILRUxtMg6Ivh/OYT5cOihKhVWFRrl1/2wLoMSb+hY\nnui97tkJyEVV79c/sR1moMcsqDyaXsHc/Mz0aQ==\n</ds:Modulus>\n<ds:Exponent>AQAB</ds:Exponent>\n</ds:RSAKeyValue>\n</ds:KeyValue>\n<ds:X509Data>\n<ds:X509Certificate>\nMIIE/DCCAuSgAwIBAgIDFBtpMA0GCSqGSIb3DQEBCwUAMHkxEDAOBgNVBAoTB1Jvb3QgQ0ExHjAc\nBgNVBAsTFWh0dHA6Ly93d3cuY2FjZXJ0Lm9yZzEiMCAGA1UEAxMZQ0EgQ2VydCBTaWduaW5nIEF1\ndGhvcml0eTEhMB8GCSqGSIb3DQEJARYSc3VwcG9ydEBjYWNlcnQub3JnMB4XDTE5MDQxNTEzNDAy\nNVoXDTE5MTAxMjEzNDAyNVowFTETMBEGA1UEAxMKc2hvbmcud2FuZzCCASIwDQYJKoZIhvcNAQEB\nBQADggEPADCCAQoCggEBAKpdY5XgeXlPhYiCudEMDHNaUuonjManIsHWB3TmpRMi2WdEsLfty7Nu\nINSrWq/miSY0iTvDo1DbHgahAj0j9qxmCHzTe3nIYFxCba/TGeb8/xvsxMmQeJXyWgW94hq3kHq3\nYJLXI5Wujwv20oha1rPcwLTKdbqMDFldk+S2OzdUmMOriz93PAmKIO7teM8B61YFrfDHin4Es518\nlW9wPURGKO6qpwLCauM30VHzNSkHqG3C2VWj0mnyugUZ9LRg6MV++n38CC0VMbTIOiL4fzmE+XDo\noSoVVhUa5df9sC6DEm/oWJ7ove7ZCchFVe/XP7EdZqDHLKg8ml7B3PzM9GkCAwEAAaOB8DCB7TAM\nBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIDqDA0BgNVHSUELTArBggrBgEFBQcDAgYIKwYBBQUH\nAwEGCWCGSAGG+EIEAQYKKwYBBAGCNwoDAzAzBggrBgEFBQcBAQQnMCUwIwYIKwYBBQUHMAGGF2h0\ndHA6Ly9vY3NwLmNhY2VydC5vcmcvMDEGA1UdHwQqMCgwJqAkoCKGIGh0dHA6Ly9jcmwuY2FjZXJ0\nLm9yZy9yZXZva2UuY3JsMC8GA1UdEQQoMCaCCnNob25nLndhbmegGAYIKwYBBQUHCAWgDAwKc2hv\nbmcud2FuZzANBgkqhkiG9w0BAQsFAAOCAgEAMDUSBLJIbJWlq7nkyMIvyOsb7LvFGsTxh5LzK9qU\n0rGwKRbArMddz/n23N6FXDr0QwFw1lrkI5dmJYOawAUF7XfXcscO2QmgerQnRWBFa2yFI4J5ML3V\n986frNEho+JzNY0cj5JTDsyll6l4hRUvJuYOpqDc2tE3nCw6zu1caWCbWI5oC5+1CgdKznEqaMbr\nGH4Ao2ah/EJuk/F4GXok6dmzLY5c6PpElv2n+tvXc4Xbj1qatflcqk3dxkjJXVU/ebRGSl/vvkm8\nPkB/g6d9Tq48twsjqEzr8wsTrDr/+suS4JBMjYT66PyNNEtsWClJ/jYdXOedRlFLdJlkNe3gVb+9\nUYJ9/StAy+8dlRH+7Q/bBPrt2GzI3fgT7LKEKtTsVhS1+XrljXqh5BZdrZEwYlyROQ4yR+doBp7E\nm3MxJTzJWdI/Rm7w9cmQT5Nai6JU4oPYkya8lOvNXZveN/PYFN0Ie3PQ9lVBp/ABpgILjjQOZraD\npn/rc/F8mH3P0xc5+6hKqFXDEBTWy/PabBs3QSyua3Db25Olq2KXC6hUVt/tvRRA1QVQAbhuGhqJ\nV63WCiZw9mNP21d8YemZairuhBZ/DEDMZs9WGQMN6oaBawVCkQyk1hVPLvq/pD8jekXKYc2YYp8P\nNzwOeODqfDg+dlvdL+7R0kJ6VsTsJYwFur4=\n</ds:X509Certificate>\n<ds:X509Certificate>\nMIIHPTCCBSWgAwIBAgIBADANBgkqhkiG9w0BAQQFADB5MRAwDgYDVQQKEwdSb290IENBMR4wHAYD\nVQQLExVodHRwOi8vd3d3LmNhY2VydC5vcmcxIjAgBgNVBAMTGUNBIENlcnQgU2lnbmluZyBBdXRo\nb3JpdHkxITAfBgkqhkiG9w0BCQEWEnN1cHBvcnRAY2FjZXJ0Lm9yZzAeFw0wMzAzMzAxMjI5NDla\nFw0zMzAzMjkxMjI5NDlaMHkxEDAOBgNVBAoTB1Jvb3QgQ0ExHjAcBgNVBAsTFWh0dHA6Ly93d3cu\nY2FjZXJ0Lm9yZzEiMCAGA1UEAxMZQ0EgQ2VydCBTaWduaW5nIEF1dGhvcml0eTEhMB8GCSqGSIb3\nDQEJARYSc3VwcG9ydEBjYWNlcnQub3JnMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA\nziLA4kZ97DYoB1CW8qAzQIxL8TtmPzHlawI229Z89vGIj053NgVBlfkJ8BLPRoZzYLdufujAWGSu\nzbCtRRcMY/pnCujW0r8+55jE8Ez64AO7NV1sId6eINm6zWYyN3L69wj1x81YyY7nDl7qPv4coRQK\nFWyGhFtkZip6qUtTefWIonvuLwphK42yfk1WpRPs6tqSnqxEQR5YYGUFZvjARL3LlPdCfgv3ZWiY\nUQXw8wWRBB0bF4LsyFe7w2t6iPGwcswlWyCR7BYCEo8y6RcYSNDHBS4CMEK4JZwFaz+qOqfrU0j3\n6NK2B5jcG8Y0f3/JHIJ6BVgrCFvzOKKrF11myZjXnhCLotLddJr3cQxyYN/Nb5gznZY0dj4kepKw\nDpUeb+agRThHqtdB7Uq3EvbXG4OKDy7YCbZZ16oE/9KTfWgu3YtLq1i6L43qlaegw1SJpfvbi1Ei\nnbLDvhG+LJGGi5Z4rSDTii8aP8bQUWWHIbEZAWV/RRyH9XzQQUxPKZgh/TMfdQwEUfoZd9vUFBzu\ngcMd9Zi3aQaRIt0AUMyBMawSB3s42mhb5ivUfslfrejrckzzAeVLIL+aplfKkQABi6F1ITe1Yw1n\nPkZPcCBnzsXWWdsC4PDSy826YreQQejdIOQpvGQpQsgi3Hia/0PsmBsJUUtaWsJx8cTLc6nloQsC\nAwEAAaOCAc4wggHKMB0GA1UdDgQWBBQWtTIb1Mfz4OaO873SsDrusjkY0TCBowYDVR0jBIGbMIGY\ngBQWtTIb1Mfz4OaO873SsDrusjkY0aF9pHsweTEQMA4GA1UEChMHUm9vdCBDQTEeMBwGA1UECxMV\naHR0cDovL3d3dy5jYWNlcnQub3JnMSIwIAYDVQQDExlDQSBDZXJ0IFNpZ25pbmcgQXV0aG9yaXR5\nMSEwHwYJKoZIhvcNAQkBFhJzdXBwb3J0QGNhY2VydC5vcmeCAQAwDwYDVR0TAQH/BAUwAwEB/zAy\nBgNVHR8EKzApMCegJaAjhiFodHRwczovL3d3dy5jYWNlcnQub3JnL3Jldm9rZS5jcmwwMAYJYIZI\nAYb4QgEEBCMWIWh0dHBzOi8vd3d3LmNhY2VydC5vcmcvcmV2b2tlLmNybDA0BglghkgBhvhCAQgE\nJxYlaHR0cDovL3d3dy5jYWNlcnQub3JnL2luZGV4LnBocD9pZD0xMDBWBglghkgBhvhCAQ0ESRZH\nVG8gZ2V0IHlvdXIgb3duIGNlcnRpZmljYXRlIGZvciBGUkVFIGhlYWQgb3ZlciB0byBodHRwOi8v\nd3d3LmNhY2VydC5vcmcwDQYJKoZIhvcNAQEEBQADggIBACjH7pyCArpcgBLKNQodgW+JapnM8mgP\nf6fhjViVPr3yBsOQWqy1YPaZQwGjiHCcnWKdpIevZ1gNMDY75q1I08t0AoZxPuIrA2jxNGJARjtT\n6ij0rPtmlVOKTV39O9lg18p5aTuxZZKmxoGCXJzN600BiqXfEVWqFcofN8CCmHBh22p8lqOOLlQ+\nTyGpkO/cgr/c6EWtTZBzCDyUZbAEmXZ/4rzCahWqlwQ3JNgelE5tDlG+1sSPypZt90Pf6DBlJzt7\nu0NDY8RD97LsaMzhGY4i+5jhe1o+ATc7iwiwovOVThrLm82asduycPAtStvYsONvRUgzEv/+PDIq\nVPfE94rwiCPCR/5kenHA0R6mY7AHfqQv0wGP3J8rtsYIqQ+TSCX8Ev2fQtzzxD72V7DX3WnRBnc0\nCkvSyqD/HMaMyRa+xMwyN2hzXwj7UfdJUzYFCpUCTPJ5GhD22Dp1nPMd8aINcGeGG7MW9S/lpOt5\nhvk9C8JzC6WZrG/8Z7jlLwumGCSNe9FINSkYQKyTYOGWhlC0elnYjyELn8+CkcY7v2vcB5G5l1Yj\nqrZslMZIBjzkzk6q5PYvCdxTby78dOs6Y5nCpqyJvKeyRKANihDjbPIky/qbn3BHLt4Ui9SyIAmW\nomTxJBzcoTWcFbLUvFUufQb1nA5V9FrWk9p2rSVzTMVD\n</ds:X509Certificate>\n</ds:X509Data>\n</ds:KeyInfo>\n</ds:Signature></ts:token>"
        tokenScriptSignatureVerifier.verifyXMLSignatureViaAPI(xml: entryTokenXMLSignedWithInvalidKey) { result in
            switch result {
            case .failed:
                break
            case .success, .unknownCn:
                XCTFail("Unexpected TokenScript signature verification result")
            }
            expectation.fulfill()
        }
        wait(for: [expectation], timeout: 30)
    }
}
